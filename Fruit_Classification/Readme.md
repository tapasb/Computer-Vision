# Fruit Detection and Classification

This project demonstrates how to detect and classify multiple fruits in an image using a combination of a custom-trained fruit classification model and a pre-trained object detection model (YOLOv5).

## Project Structure

*   `CreateModel.py`:  This script trains a fruit classification model using a dataset of fruit images.
*   `Test.py`:  This script uses the trained fruit classification model and a YOLOv5 model to detect and classify fruits in an image.
*   `data/`: This directory should contain the fruit image dataset used for training and testing.
    *   `train/`:  Contains training images organized into subfolders for each fruit class.
    *   `test/`:  Contains test images.
*   `fruit_classification_model.h5`:  The saved trained fruit classification model (generated by `CreateModel.py`).
*   `TestImage.jpg`: An example image for testing the `Test.py` script.

## Setup

1.  **Install required libraries:**

    ```bash
    pip install tensorflow ultralytics torch Pillow numpy
    ```

2.  **Prepare the dataset:**
    *   Organize your fruit image dataset into the `data/` directory as described in the "Project Structure" section.
    *   Make sure the `TRAIN_DIR` and `TEST_DIR` variables in `CreateModel.py` are correctly set to the paths of your training and test data.

3.  **Train the classification model:**
    *   Run the `CreateModel.py` script to train the fruit classification model. This will generate the `fruit_classification_model.h5` file.

## Usage

1.  **Place a test image:**
    *   Put an image containing multiple fruits in the project directory (e.g., `TestImage.jpg`).
    *   Update the `image_path` variable in `Test.py` to point to your test image.

2.  **Run the detection and classification script:**

    ```bash
    python Test.py
    ```

    This will:
    *   Load the trained classification model and the YOLOv5 model.
    *   Detect potential fruit regions in the image using YOLOv5.
    *   Crop each detected region and classify the fruit using the trained classification model.
    *   Draw bounding boxes around the detected fruits and label them with the predicted class names.
    *   Display the resulting image with the detections and classifications.

## Notes

*   The `Test.py` script uses a pre-trained YOLOv5s model by default. You can experiment with other YOLOv5 versions (yolov5m, yolov5l, etc.) by changing the model name in the `YOLO()` constructor.
*   Adjust the confidence threshold (`conf > 0.5`) in `Test.py` to fine-tune the detection sensitivity.
*   The performance of the system depends on the quality of both the object detection model and the trained classification model.

## Potential Improvements

*   Fine-tune the YOLOv5 model on your specific fruit dataset to improve detection accuracy.
*   Experiment with different classification model architectures or hyperparameters to improve classification performance.
*   Implement a more robust method for handling overlapping bounding boxes (e.g., Non-Maximum Suppression).
*   Add error handling for cases where no fruits are detected or the classification model is uncertain.